<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cl.dao.PulldownMenuMapper">
    <resultMap id="BaseResultMap" type="com.cl.bean.res.PulldownMenuResBean">
        <id column="id" jdbcType="BIGINT" property="id" />
        <result column="name" jdbcType="VARCHAR" property="name" />
        <result column="code" jdbcType="VARCHAR" property="code" />
    </resultMap>

    <select id="queryOrgPulldownMenu" resultMap="BaseResultMap" parameterType="com.cl.bean.res.PulldownMenuResBean">
        SELECT
          id ,
          name
        FROM
          sys_org
        WHERE
          status = 1
        <if test="name != null  and name !='' ">
            AND name = #{name}
        </if>
        <if test="id !=null  ">
            AND id = #{id}
        </if>
    </select>

    <select id="queryUserPulldownMenu" resultMap="BaseResultMap" parameterType="com.cl.bean.res.PulldownMenuResBean">
        SELECT
        id ,
        user_name name
        FROM
        sys_user
        WHERE
        status = 1
        <if test="name != null  and name !='' ">
            AND user_name = #{name}
        </if>
        <if test="id !=null  ">
            AND id = #{id}
        </if>
    </select>

    <select id="queryInputByOrderNumer" resultType="string">
        SELECT
          order_no
        FROM
          order_manage
        WHERE
        order_status != 0
        order by
        last_update_time
        desc
    </select>

    <select id="queryInputBySku" resultType="string">
        SELECT
         sku
        FROM
        order_manage
        WHERE
        order_status != 0
        GROUP BY sku
    </select>

    <select id="queryInputByPurchaseNumber" resultType="string">
        SELECT
          purchase_no
        FROM
          purchase
        WHERE
        purchase_status != 0
        order by
        last_update_time
        desc
    </select>

    <select id="queryInputSupplierName" resultType="string">
        SELECT
        supplier_name
        FROM
        purchase
        WHERE
        purchase_status != 0
        GROUP BY supplier_name
    </select>

    <select id="queryDictItemList" resultType="com.cl.bean.res.DictItem" parameterType="com.cl.bean.res.DictItem">
        SELECT
          scd.code ,
          scd.value
        FROM
          sys_code sc
        LEFT JOIN
          sys_code_detail scd
        ON sc.id = scd.sys_code_id
        WHERE sc.type = #{type}
        <if test="code != null and code !='' ">
            scd.code = #{code}
        </if>
        <if test="value != null and value !='' ">
            scd.value = #{value}
        </if>
        AND sc.status = 1d
        AND sc.status = 1
    </select>
</mapper>